# AF Sprint 1 Dependency Map (FAZ-ADMIN-FINAL)

| Feature | API Endpoints | DB Tabloları / Alanlar | UI Ekranları | RBAC İzinleri | Audit Event’ler | Test Kanıtı |
| --- | --- | --- | --- | --- | --- | --- |
| **AF1.1 Plan Yönetimi Sertleştirme** | `GET/POST/PUT /admin/plans`, `POST /admin/plans/{id}/toggle-active`, `POST /admin/plans/{id}/archive` | `plans` (listing_quota, showcase_quota, price_amount, period, country_scope) | `AdminPlans.js` | `super_admin`, `finance` | **GAP:** plan create/update/toggle için audit yok | Plan create/update validation + quota guard curl/Playwright |
| **AF1.2 Dealer Plan Override** | `POST /admin/dealers/{dealer_id}/plan` | `users.plan_id`, `plans` | `AdminDealerDetail.js`, `Dealers.js` | `super_admin`, `country_admin`, `moderator` | `ADMIN_PLAN_ASSIGNMENT` (mevcut) | Plan assign + audit log doğrulama |
| **AF2.1 Risk Level (low/medium/high)** | **GAP:** admin update endpoint yok | **GAP:** `users.risk_level` alanı yok | **GAP:** Admin Users/Dealer UI kontrolü yok | TBD (öneri: `super_admin`, `moderator`) | **GAP:** `RISK_LEVEL_UPDATED` | API + UI toggle + audit log |
| **AF2.2 Ban/Suspend Guard** | `POST /admin/users/{id}/suspend`, `POST /admin/users/{id}/activate` | `users.status`, `users.is_active`, `users.suspension_until`, `users.dealer_status` | `Dealers.js` (action modal) | `super_admin`, `moderator` | `user_suspended` / `dealer_suspended` (mevcut) | Suspend reason + login guard (403) |
| **AF3.1 Verified Dealer Toggle** | **GAP:** admin verify endpoint yok | `dealer_profiles.verification_status` | **GAP:** Dealer panel verified badge UI yok | TBD (öneri: `super_admin`, `country_admin`) | **GAP:** `DEALER_VERIFIED` / `DEALER_UNVERIFIED` | Admin toggle + dealer badge doğrulama |
| **AF4.1 Bulk Approve/Reject** | `POST /admin/moderation/bulk-approve`, `POST /admin/moderation/bulk-reject` | `listings`, `moderation_items` | `ModerationQueue.js` | `super_admin`, `country_admin`, `moderator` | Moderation audit (transition log) | Bulk approve/reject + reason zorunluluğu |
| **AF4.2 Moderation Filters** | `GET /admin/moderation/queue` (status, module, country, dealer_only) | `listings`, `moderation_items` | `ModerationQueue.js` | `super_admin`, `country_admin`, `moderator` | Audit gerekli değil | **GAP:** date range + category filtreleri |
| **AF5.1 Finance Widgets** | `GET /admin/dashboard/summary` (read-only) | `admin_invoices`, `listings`, `users`, `subscriptions` | **GAP:** Admin dashboard widget UI yok | `super_admin`, `finance`, `country_admin`, `support` | `dashboard_export_pdf` (export) | Revenue/active subscriptions widget testi |
